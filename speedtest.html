<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>반응속도</title>
  <style>
    #screen {
      width: 300px;
      height: 200px;
      text-align: center;
      user-select: none;
    }
    #screen.waiting {
      background-color: aqua;
    }
    #screen.ready {
      background-color: red;
      color: white;
    }
    #screen.now {
      background-color: greenyellow;
    }
  </style>
</head>

<body>
  <div id="screen" class="waiting">클릭해서 시작하세요</div>
  <div id="result"></div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const display = document.querySelector("#screen");
      const output = document.querySelector("#result");

      let start; 
      let end; 
      let reactionTime; 
      let times = [];
      let timerId; 

      display.addEventListener("click", () => {
        if (display.classList.contains("waiting")) {
          display.classList.replace("waiting", "ready");
          display.textContent = "초록색이 되면 클릭하세요";

          timerId = setTimeout(() => {
            start = new Date();
            display.classList.replace("ready", "now");
            display.textContent = "클릭!";
          }, Math.floor(Math.random() * 1000) + 2000);
          
        } else if (display.classList.contains("ready")) {
          clearTimeout(timerId);
          display.textContent = '빨라유';
          display.classList.replace('ready', 'waiting');
          
        } else if (display.classList.contains("now")) {
          end = new Date();
          reactionTime = end - start;
          times.push(reactionTime);

          let avg = times.reduce((sum, time) => sum + time, 0) / times.length;
          output.textContent = '현재 : ' + reactionTime + " ms" + ' ' + '평균 속도 : ' + avg;

          display.classList.replace("now", "waiting");
          display.textContent = "클릭해서 시작하세요";
        }
      });
    });
  </script>
</body>
</html>
